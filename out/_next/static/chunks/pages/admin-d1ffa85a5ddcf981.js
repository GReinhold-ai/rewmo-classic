(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[309],{4768:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){return t(5067)}])},5067:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>h});var a=t(7876),l=t(4232),n=t(6064),r=t(9099),d=t(8230),i=t.n(d),c=t(2009),o=t(3311);let x=["gary@rewmo.ai","youradmin@rewmo.ai"];function h(){let{currentUser:e}=(0,n.A)();(0,r.useRouter)();let[s,t]=(0,l.useState)(!0),[d,h]=(0,l.useState)([]),[m,g]=(0,l.useState)(null),[u,f]=(0,l.useState)(0),[j,N]=(0,l.useState)(0),[b,v]=(0,l.useState)(0),[w,p]=(0,l.useState)(0),[y,R]=(0,l.useState)(0),[C,S]=(0,l.useState)(0),[k,A]=(0,l.useState)(0),[E,_]=(0,l.useState)(0),P=e&&x.includes(e.email||"");return((0,l.useEffect)(()=>{P&&(t(!0),g(null),e());async function e(){try{let e=await (0,c.GG)((0,c.rJ)(o.db,"users")),s=0,t=0,a=0,l=0,n=0,r=0,d=0,i=[];e.forEach(e=>{let c=e.data();s+=c.referralCount||0,t+=c.rewardPoints||0,c.consented&&(a+=1),c.viewedDisclosure&&(l+=1),c.affiliateClicks&&(n+=c.affiliateClicks),c.affiliatePurchases&&(r+=c.affiliatePurchases),c.affiliateRevenue&&(d+=c.affiliateRevenue),i.push({email:c.email,referrals:c.referralCount||0,rewards:c.rewardPoints||0,consented:!!c.consented})}),f(e.size),N(s),v(t),A(a),_(l),p(n),R(r),S(d),h(i)}catch(e){g("Failed to fetch analytics. "+(e.message||""))}t(!1)}},[P]),P)?(0,a.jsxs)("div",{className:"min-h-screen bg-black text-orange-50 px-4 py-8",children:[(0,a.jsxs)("nav",{className:"flex gap-6 items-center mb-8",children:[(0,a.jsx)(i(),{href:"/dashboard",className:"text-orange-400 hover:underline font-semibold",children:"Dashboard"}),(0,a.jsx)(i(),{href:"/rewards",className:"text-orange-400 hover:underline font-semibold",children:"Rewards"}),(0,a.jsx)(i(),{href:"/analytics",className:"text-orange-400 hover:underline font-semibold",children:"Analytics"}),(0,a.jsx)(i(),{href:"/profile",className:"text-orange-400 hover:underline font-semibold",children:"Profile"}),(0,a.jsx)(i(),{href:"/admin",className:"text-orange-200 underline font-bold",children:"Admin"})]}),(0,a.jsx)("h1",{className:"text-3xl font-extrabold mb-8 text-orange-400",children:"Rewmo Admin Dashboard"}),s?(0,a.jsx)("div",{className:"text-center text-orange-200 text-lg py-12",children:"Loading live analytics..."}):m?(0,a.jsx)("div",{className:"text-red-400 bg-white/10 rounded-xl p-4 mb-8",children:m}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-8 mb-10",children:[(0,a.jsxs)("div",{className:"bg-orange-400/10 rounded-xl p-6 shadow-lg text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-300",children:u}),(0,a.jsx)("div",{className:"text-lg text-orange-200 mt-2",children:"Total Users"})]}),(0,a.jsxs)("div",{className:"bg-orange-400/10 rounded-xl p-6 shadow-lg text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-300",children:j}),(0,a.jsx)("div",{className:"text-lg text-orange-200 mt-2",children:"Referrals"})]}),(0,a.jsxs)("div",{className:"bg-orange-400/10 rounded-xl p-6 shadow-lg text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-300",children:b}),(0,a.jsx)("div",{className:"text-lg text-orange-200 mt-2",children:"Rewards Points Awarded"})]}),(0,a.jsxs)("div",{className:"bg-orange-400/10 rounded-xl p-6 shadow-lg text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-300",children:w}),(0,a.jsx)("div",{className:"text-lg text-orange-200 mt-2",children:"Affiliate Clicks"})]}),(0,a.jsxs)("div",{className:"bg-orange-400/10 rounded-xl p-6 shadow-lg text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-300",children:y}),(0,a.jsx)("div",{className:"text-lg text-orange-200 mt-2",children:"Affiliate Purchases"})]}),(0,a.jsxs)("div",{className:"bg-orange-400/10 rounded-xl p-6 shadow-lg text-center",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-orange-300",children:["$",C.toFixed(2)]}),(0,a.jsx)("div",{className:"text-lg text-orange-200 mt-2",children:"Affiliate Revenue"})]}),(0,a.jsxs)("div",{className:"bg-orange-400/10 rounded-xl p-6 shadow-lg text-center",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-orange-300",children:[0===u?0:(k/u*100).toFixed(1),"%"]}),(0,a.jsx)("div",{className:"text-lg text-orange-200 mt-2",children:"Consented to Terms"})]}),(0,a.jsxs)("div",{className:"bg-orange-400/10 rounded-xl p-6 shadow-lg text-center",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-orange-300",children:[0===u?0:(E/u*100).toFixed(1),"%"]}),(0,a.jsx)("div",{className:"text-lg text-orange-200 mt-2",children:"Viewed Disclosure"})]})]}),(0,a.jsxs)("div",{className:"bg-orange-500/10 rounded-xl shadow-lg p-6 mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-orange-300",children:"Sample Users"}),(0,a.jsx)("button",{className:"px-4 py-2 bg-orange-600 hover:bg-orange-700 rounded text-white font-semibold shadow",onClick:()=>{let e=new Blob(["Email,Referrals,Rewards,Consented\n"+d.map(e=>"".concat(e.email||"",",").concat(e.referrals,",").concat(e.rewards,",").concat(e.consented?"Yes":"No")).join("\n")],{type:"text/csv"}),s=URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="rewmo-users.csv",t.click(),URL.revokeObjectURL(s)},children:"Export CSV"})]}),(0,a.jsxs)("table",{className:"w-full text-orange-100 border-separate border-spacing-y-2",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left",children:"Email"}),(0,a.jsx)("th",{children:"Referrals"}),(0,a.jsx)("th",{children:"Rewards"}),(0,a.jsx)("th",{children:"Consented"})]})}),(0,a.jsx)("tbody",{children:d.slice(0,10).map((e,s)=>(0,a.jsxs)("tr",{className:"bg-orange-800/20 rounded",children:[(0,a.jsx)("td",{className:"py-1",children:e.email||(0,a.jsx)("span",{className:"text-orange-700",children:"N/A"})}),(0,a.jsx)("td",{className:"text-center",children:e.referrals}),(0,a.jsx)("td",{className:"text-center",children:e.rewards}),(0,a.jsx)("td",{className:"text-center",children:e.consented?"Yes":"No"})]},s))})]}),(0,a.jsxs)("div",{className:"text-orange-300 mt-2 text-sm",children:["Showing ",Math.min(d.length,10)," of ",d.length," users."]})]}),(0,a.jsxs)("div",{className:"bg-orange-800/20 rounded-xl p-4 text-orange-200 text-sm mb-12",children:[(0,a.jsx)("b",{children:"SEC Compliance Note:"})," All user data is managed per US data security guidelines. Consents/disclosures are logged for RegCF. For full analytics, connect Firestore queries."]})]})]}):(0,a.jsx)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-black text-white",children:(0,a.jsxs)("div",{className:"bg-orange-900/70 rounded-xl shadow-lg px-8 py-6 text-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-orange-300 mb-2",children:"Admin Access Only"}),(0,a.jsx)("p",{className:"text-orange-100",children:"You must be an admin to view this page."})]})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[636,593,792],()=>s(4768)),_N_E=e.O()}]);